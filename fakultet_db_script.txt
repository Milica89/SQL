CREATE DATABASE fakultet
ON PRIMARY
(NAME=fakultet,
FILENAME='D:\Jovan Vulin\FitnessJournal\fakultet.mdf',
SIZE=4MB,
FILEGROWTH=1MB);
GO

USE fakultet
GO

CREATE TABLE NASTAVNIK (
  ID INTEGER  NOT NULL   IDENTITY,
  IME VARCHAR(50),
  PREZIME VARCHAR(200),
PRIMARY KEY(ID));
GO

CREATE TABLE PREDMET (
  ID INTEGER  NOT NULL   IDENTITY,
  NAZIV VARCHAR(50),
  ESPB INTEGER,
PRIMARY KEY(ID));
GO


CREATE TABLE STUDENT (
  ID INTEGER  NOT NULL   IDENTITY,
  IME VARCHAR(30),
  PREZIME VARCHAR(50),
  STATUS VARCHAR(20),
PRIMARY KEY(ID));
GO

CREATE TABLE GODINA (
  ID INTEGER  NOT NULL   IDENTITY,
PRIMARY KEY(ID));
GO

CREATE TABLE RAD (
  ID INTEGER  NOT NULL   IDENTITY,
  STUDENT_ID INTEGER  NOT NULL,
NASTAVNIK_ID INTEGER NOT NULL,
  NAZIV VARCHAR(30),
  DATUM DATETIME,
PRIMARY KEY(ID),
  FOREIGN KEY(STUDENT_ID)
REFERENCES STUDENT(ID),
  FOREIGN KEY(NASTAVNIK_ID)
REFERENCES NASTAVNIK(ID));
GO

CREATE TABLE FAKULTET (
  ID INTEGER  NOT NULL   IDENTITY ,
  NASTAVNIK_ID INTEGER  NOT NULL,
  NAZIV VARCHAR(50),
  ADRESA VARCHAR(30),
PRIMARY KEY(ID),
  FOREIGN KEY(NASTAVNIK_ID)
REFERENCES NASTAVNIK(ID));
GO

CREATE TABLE SMER (
  ID INTEGER  NOT NULL   IDENTITY,
  FAKULTET_ID INTEGER  NOT NULL,
  NAZIV VARCHAR(50),	
PRIMARY KEY(ID),
  FOREIGN KEY(FAKULTET_ID)
REFERENCES FAKULTET(ID));
GO

CREATE TABLE ZAPOSLEN (
  NASTAVNIK_ID INTEGER  NOT NULL,
  FAKULTET_ID INTEGER  NOT NULL,
PRIMARY KEY(NASTAVNIK_ID, FAKULTET_ID),
  FOREIGN KEY(FAKULTET_ID)
REFERENCES FAKULTET(ID),
  FOREIGN KEY(NASTAVNIK_ID)
REFERENCES NASTAVNIK(ID));
GO

CREATE TABLE PREDAJE (
  NASTAVNIK_ID INTEGER  NOT NULL,
  PREDMET_ID INTEGER  NOT NULL,
PRIMARY KEY(NASTAVNIK_ID, PREDMET_ID),
  FOREIGN KEY(NASTAVNIK_ID)
REFERENCES NASTAVNIK(ID),
  FOREIGN KEY(PREDMET_ID)
REFERENCES PREDMET(ID));
GO

CREATE TABLE PREDMET_SMER_GODINA (
  PREDMET_ID INTEGER  NOT NULL,
  SMER_ID INTEGER  NOT NULL,
  GODINA_ID INTEGER  NOT NULL,
PRIMARY KEY(PREDMET_ID, SMER_ID, GODINA_ID),
  FOREIGN KEY(PREDMET_ID)
REFERENCES PREDMET(ID),
  FOREIGN KEY(SMER_ID)
REFERENCES SMER(ID),
  FOREIGN KEY(GODINA_ID)
REFERENCES GODINA(ID));
GO

CREATE TABLE STUDENT_SMER_GODINA (
  STUDENT_ID INTEGER  NOT NULL,
  SMER_ID INTEGER  NOT NULL,
  GODINA_ID INTEGER  NOT NULL ,
PRIMARY KEY(STUDENT_ID, SMER_ID, GODINA_ID)    ,
  FOREIGN KEY(STUDENT_ID)
    REFERENCES STUDENT(ID),
  FOREIGN KEY(SMER_ID)
    REFERENCES SMER(ID),
  FOREIGN KEY(GODINA_ID)
    REFERENCES GODINA(ID));
GO

CREATE TABLE ISPIT (
  DATUM DATETIME  NOT NULL,
  STUDENT_ID INTEGER  NOT NULL,
  PREDMET_ID INTEGER  NOT NULL,
  OCENA INTEGER,
PRIMARY KEY(DATUM, STUDENT_ID, PREDMET_ID),
  FOREIGN KEY(STUDENT_ID)
    REFERENCES STUDENT(ID),
  FOREIGN KEY(PREDMET_ID)
    REFERENCES PREDMET(ID));
GO